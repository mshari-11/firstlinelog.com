# Ù†Ø¸Ø§Ù… Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Excel Ø§Ù„ÙŠÙˆÙ…ÙŠ
# Daily Excel Upload System

## Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù†Ø¸Ø§Ù… Ø±ÙØ¹ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„ÙØ§Øª Excel Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù…Ù† Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØµÙŠÙ„ (Jahez, HungerStation, Marsool, Ø¥Ù„Ø®) Ù„Ø­Ø³Ø§Ø¨ Ø±ÙˆØ§ØªØ¨ ÙˆÙ…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨.

---

## ğŸ¯ Ø§Ù„Ù‡Ø¯Ù

ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ÙŠØ¯ÙˆÙŠØ© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„ÙØ§Øª Excel Ø¥Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø¢Ù„ÙŠ:
1. Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
2. ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
3. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
4. Ù†Ø¸Ø§Ù… Ø§Ø¹ØªÙ…Ø§Ø¯ Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª
5. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨

---

## ğŸ“‹ Ù‡ÙŠÙƒÙ„ Ù…Ù„Ù Excel Ø§Ù„Ù…Ø·Ù„ÙˆØ¨

### Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Required Columns)

| Ø§Ù„Ø¹Ù…ÙˆØ¯ | Column Name | Ø§Ù„Ù†ÙˆØ¹ | Ù…Ø«Ø§Ù„ | Ù…Ù„Ø§Ø­Ø¸Ø§Øª |
|--------|-------------|------|------|---------|
| Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ | courier_name | Ù†Øµ | Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ | Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ |
| Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ | phone_number | Ù†Øµ | 966501234567 | Ù…Ø¹ ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø© |
| Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© | national_id | Ù†Øµ | 1234567890 | 10 Ø£Ø±Ù‚Ø§Ù… |
| Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª | orders_count | Ø±Ù‚Ù… | 150 | Ø¹Ø¯Ø¯ ØµØ­ÙŠØ­ |
| Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª | total_revenue | Ø±Ù‚Ù… | 4500.50 | Ø¨Ø§Ù„Ø±ÙŠØ§Ù„ |
| Ø§Ù„Ù…Ù†ØµØ© | platform | Ù†Øµ | Jahez | Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØµØ© |
| Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© | vehicle_type | Ù†Øµ | Ø³ÙŠØ§Ø±Ø© | Ø³ÙŠØ§Ø±Ø©/Ø¯Ø±Ø§Ø¬Ø©/Ø¯Ø¨Ø§Ø¨ |
| Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ | courier_status | Ù†Øµ | Ù…Ø±ÙƒØ¨ | Ù…Ø±ÙƒØ¨/ØªØ·Ø¨ÙŠÙ‚ |
| Ø§Ù„ØªØ§Ø±ÙŠØ® | date | ØªØ§Ø±ÙŠØ® | 2026-02-18 | YYYY-MM-DD |

### Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© (Optional Columns)

| Ø§Ù„Ø¹Ù…ÙˆØ¯ | Column Name | Ø§Ù„Ù†ÙˆØ¹ | Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ |
|--------|-------------|------|-----------|
| Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© | city | Ù†Øµ | - |
| Ø§Ù„Ø­ÙŠ | district | Ù†Øµ | - |
| Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„ | working_hours | Ø±Ù‚Ù… | - |
| Ù†Ù‚Ø§Ø· Ø§Ù„Ø¬ÙˆØ¯Ø© | quality_score | Ø±Ù‚Ù… | 0 |
| Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª | deductions | Ø±Ù‚Ù… | 0 |
| Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª | bonuses | Ø±Ù‚Ù… | 0 |

---

## ğŸ”„ Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ (Workflow)

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ù„Ø±ÙØ¹ (Upload)

```typescript
// Frontend: Excel Upload Component
interface ExcelUploadProps {
  onUploadSuccess: (fileId: string) => void;
  onUploadError: (error: Error) => void;
}

const ExcelUpload: React.FC<ExcelUploadProps> = ({ onUploadSuccess, onUploadError }) => {
  const handleFileUpload = async (file: File) => {
    // Validate file
    if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
      onUploadError(new Error('ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ù…Ù„Ù Excel (.xlsx Ø£Ùˆ .xls)'));
      return;
    }

    // Check file size (max 10MB)
    if (file.size > 10 * 1024 * 1024) {
      onUploadError(new Error('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† 10 Ù…ÙŠØ¬Ø§'));
      return;
    }

    // Upload to S3
    const formData = new FormData();
    formData.append('file', file);
    
    const response = await fetch('/api/excel/upload', {
      method: 'POST',
      body: formData
    });

    const data = await response.json();
    onUploadSuccess(data.fileId);
  };

  return (
    <div className="upload-area">
      <input 
        type="file" 
        accept=".xlsx,.xls"
        onChange={(e) => handleFileUpload(e.target.files[0])}
      />
    </div>
  );
};
```

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„ (Parse)

```typescript
// Backend: Parse Excel file
import * as XLSX from 'xlsx';
import { S3Client, GetObjectCommand } from '@aws-sdk/client-s3';

interface ExcelRow {
  courier_name: string;
  phone_number: string;
  national_id: string;
  orders_count: number;
  total_revenue: number;
  platform: string;
  vehicle_type: string;
  courier_status: string;
  date: string;
}

const parseExcelFile = async (fileKey: string): Promise<ExcelRow[]> => {
  // Download from S3
  const s3 = new S3Client({ region: process.env.AWS_S3_REGION });
  const command = new GetObjectCommand({
    Bucket: process.env.AWS_S3_BUCKET,
    Key: fileKey
  });
  
  const response = await s3.send(command);
  const buffer = await streamToBuffer(response.Body);
  
  // Parse Excel
  const workbook = XLSX.read(buffer, { type: 'buffer' });
  const sheetName = workbook.SheetNames[0];
  const sheet = workbook.Sheets[sheetName];
  
  // Convert to JSON
  const rows: ExcelRow[] = XLSX.utils.sheet_to_json(sheet);
  
  return rows;
};
```

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Cleaning)

```typescript
// Data cleaning with Claude AI
import { claude } from '@/lib/claude';

interface CleanedData {
  original: ExcelRow;
  cleaned: ExcelRow;
  issues: string[];
  confidence: number;
}

const cleanExcelData = async (rows: ExcelRow[]): Promise<CleanedData[]> => {
  const cleaned: CleanedData[] = [];
  
  for (const row of rows) {
    const issues: string[] = [];
    const cleanedRow = { ...row };
    
    // 1. Clean courier name
    if (row.courier_name) {
      cleanedRow.courier_name = row.courier_name
        .trim()
        .replace(/\s+/g, ' ')
        .replace(/[0-9]/g, ''); // Remove numbers
      
      if (cleanedRow.courier_name !== row.courier_name) {
        issues.push('ØªÙ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³Ù…');
      }
    } else {
      issues.push('Ø§Ù„Ø§Ø³Ù… Ù…ÙÙ‚ÙˆØ¯');
    }
    
    // 2. Validate phone number
    if (row.phone_number) {
      let phone = row.phone_number.toString().replace(/\D/g, '');
      
      // Add country code if missing
      if (!phone.startsWith('966')) {
        if (phone.startsWith('0')) {
          phone = '966' + phone.substring(1);
        } else if (phone.length === 9) {
          phone = '966' + phone;
        }
        issues.push('ØªÙ… Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø©');
      }
      
      cleanedRow.phone_number = phone;
      
      // Validate length
      if (phone.length !== 12) {
        issues.push('Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ ØºÙŠØ± ØµØ­ÙŠØ­');
      }
    } else {
      issues.push('Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ù…ÙÙ‚ÙˆØ¯');
    }
    
    // 3. Validate national ID
    if (row.national_id) {
      const id = row.national_id.toString().replace(/\D/g, '');
      cleanedRow.national_id = id;
      
      if (id.length !== 10) {
        issues.push('Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© ØºÙŠØ± ØµØ­ÙŠØ­ (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 10 Ø£Ø±Ù‚Ø§Ù…)');
      }
    } else {
      issues.push('Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ù…ÙÙ‚ÙˆØ¯');
    }
    
    // 4. Validate numbers
    cleanedRow.orders_count = parseInt(row.orders_count?.toString() || '0');
    cleanedRow.total_revenue = parseFloat(row.total_revenue?.toString() || '0');
    
    if (cleanedRow.orders_count < 0) {
      issues.push('Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø³Ø§Ù„Ø¨');
      cleanedRow.orders_count = 0;
    }
    
    if (cleanedRow.total_revenue < 0) {
      issues.push('Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø³Ø§Ù„Ø¨Ø©');
      cleanedRow.total_revenue = 0;
    }
    
    // 5. Standardize platform name
    const platformMap: Record<string, string> = {
      'Ø¬Ø§Ù‡Ø²': 'Jahez',
      'Ù‡Ù†Ù‚Ø±Ø³ØªÙŠØ´Ù†': 'HungerStation',
      'Ù…Ø±Ø³ÙˆÙ„': 'Marsool',
      'ØªÙˆØµÙŠÙ„': 'Jahez'
    };
    
    if (row.platform && platformMap[row.platform]) {
      cleanedRow.platform = platformMap[row.platform];
      issues.push('ØªÙ… ØªÙˆØ­ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØµØ©');
    }
    
    // 6. Validate date
    if (row.date) {
      try {
        const date = new Date(row.date);
        if (isNaN(date.getTime())) {
          issues.push('Ø§Ù„ØªØ§Ø±ÙŠØ® ØºÙŠØ± ØµØ­ÙŠØ­');
          cleanedRow.date = new Date().toISOString().split('T')[0];
        } else {
          cleanedRow.date = date.toISOString().split('T')[0];
        }
      } catch (error) {
        issues.push('Ø§Ù„ØªØ§Ø±ÙŠØ® ØºÙŠØ± ØµØ­ÙŠØ­');
        cleanedRow.date = new Date().toISOString().split('T')[0];
      }
    }
    
    // Calculate confidence score
    const confidence = Math.max(0, 100 - (issues.length * 10));
    
    cleaned.push({
      original: row,
      cleaned: cleanedRow,
      issues,
      confidence
    });
  }
  
  return cleaned;
};
```

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª (Apply Calculations)

```typescript
// Salary calculation engine
interface SalaryCalculation {
  courierId: string;
  courierName: string;
  totalOrders: number;
  totalRevenue: number;
  baseSalary: number;
  commission: number;
  bonuses: number;
  deductions: number;
  netSalary: number;
  breakdown: {
    perOrderRate: number;
    revenuePercentage: number;
    qualityBonus: number;
    attendanceBonus: number;
  };
}

const calculateSalary = async (
  row: ExcelRow,
  courierData: any
): Promise<SalaryCalculation> => {
  // Get courier configuration
  const config = await getCourierConfiguration(courierData);
  
  // Base calculations
  let baseSalary = 0;
  let commission = 0;
  let bonuses = 0;
  let deductions = 0;
  
  // 1. Calculate based on courier status
  if (row.courier_status === 'Ù…Ø±ÙƒØ¨') {
    // Own vehicle - higher commission
    const perOrderRate = config.ownVehicleRate || 10; // 10 SAR per order
    baseSalary = row.orders_count * perOrderRate;
    
    // Revenue percentage
    const revenuePercentage = config.ownVehicleRevPercent || 0.15; // 15%
    commission = row.total_revenue * revenuePercentage;
  } else {
    // Company vehicle - lower commission
    const perOrderRate = config.companyVehicleRate || 7; // 7 SAR per order
    baseSalary = row.orders_count * perOrderRate;
    
    const revenuePercentage = config.companyVehicleRevPercent || 0.10; // 10%
    commission = row.total_revenue * revenuePercentage;
    
    // Deduct vehicle maintenance
    deductions += config.vehicleMaintenance || 200; // 200 SAR/month
  }
  
  // 2. Vehicle type bonus
  if (row.vehicle_type === 'Ø¯Ø±Ø§Ø¬Ø©') {
    bonuses += config.motorcycleBonus || 300; // 300 SAR bonus
  }
  
  // 3. Platform-specific adjustments
  const platformRates: Record<string, number> = {
    'Jahez': 1.0,
    'HungerStation': 1.05,
    'Marsool': 0.95
  };
  
  const platformMultiplier = platformRates[row.platform] || 1.0;
  baseSalary *= platformMultiplier;
  commission *= platformMultiplier;
  
  // 4. Performance bonuses
  if (row.orders_count >= 200) {
    bonuses += 500; // High performance bonus
  } else if (row.orders_count >= 150) {
    bonuses += 300;
  } else if (row.orders_count >= 100) {
    bonuses += 150;
  }
  
  // 5. Quality score bonus (if available)
  const qualityScore = (row as any).quality_score || 0;
  if (qualityScore >= 4.8) {
    bonuses += 200;
  } else if (qualityScore >= 4.5) {
    bonuses += 100;
  }
  
  // 6. Calculate net salary
  const netSalary = baseSalary + commission + bonuses - deductions;
  
  return {
    courierId: courierData.id,
    courierName: row.courier_name,
    totalOrders: row.orders_count,
    totalRevenue: row.total_revenue,
    baseSalary: Math.round(baseSalary * 100) / 100,
    commission: Math.round(commission * 100) / 100,
    bonuses: Math.round(bonuses * 100) / 100,
    deductions: Math.round(deductions * 100) / 100,
    netSalary: Math.round(netSalary * 100) / 100,
    breakdown: {
      perOrderRate: config.ownVehicleRate || config.companyVehicleRate,
      revenuePercentage: config.ownVehicleRevPercent || config.companyVehicleRevPercent,
      qualityBonus: qualityScore >= 4.5 ? (qualityScore >= 4.8 ? 200 : 100) : 0,
      attendanceBonus: row.orders_count >= 100 ? 150 : 0
    }
  };
};

// Helper: Get courier configuration
const getCourierConfiguration = async (courierData: any) => {
  // This would be fetched from database
  return {
    ownVehicleRate: 10,
    ownVehicleRevPercent: 0.15,
    companyVehicleRate: 7,
    companyVehicleRevPercent: 0.10,
    vehicleMaintenance: 200,
    motorcycleBonus: 300
  };
};
```

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 5: Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ (Approval System)

```typescript
// Multi-level approval workflow
enum ApprovalStatus {
  PENDING = 'pending',
  FINANCE_APPROVED = 'finance_approved',
  ACCOUNTING_APPROVED = 'accounting_approved',
  HR_APPROVED = 'hr_approved',
  VEHICLE_APPROVED = 'vehicle_approved',
  FINAL_APPROVED = 'final_approved',
  REJECTED = 'rejected'
}

interface ApprovalWorkflow {
  id: string;
  uploadId: string;
  status: ApprovalStatus;
  currentStep: number;
  steps: ApprovalStep[];
  createdAt: Date;
  updatedAt: Date;
}

interface ApprovalStep {
  step: number;
  department: string;
  approver: string | null;
  status: 'pending' | 'approved' | 'rejected';
  comments: string | null;
  approvedAt: Date | null;
}

const createApprovalWorkflow = async (uploadId: string): Promise<ApprovalWorkflow> => {
  const workflow: ApprovalWorkflow = {
    id: generateId(),
    uploadId,
    status: ApprovalStatus.PENDING,
    currentStep: 1,
    steps: [
      {
        step: 1,
        department: 'finance',
        approver: null,
        status: 'pending',
        comments: null,
        approvedAt: null
      },
      {
        step: 2,
        department: 'accounting',
        approver: null,
        status: 'pending',
        comments: null,
        approvedAt: null
      },
      {
        step: 3,
        department: 'hr',
        approver: null,
        status: 'pending',
        comments: null,
        approvedAt: null
      },
      {
        step: 4,
        department: 'vehicle',
        approver: null,
        status: 'pending',
        comments: null,
        approvedAt: null
      }
    ],
    createdAt: new Date(),
    updatedAt: new Date()
  };
  
  // Save to database
  await db.approvalWorkflow.create({ data: workflow });
  
  // Notify first approver (Finance)
  await notifyApprover('finance', workflow.id);
  
  return workflow;
};

// Approve step
const approveStep = async (
  workflowId: string,
  department: string,
  approverId: string,
  comments?: string
) => {
  const workflow = await db.approvalWorkflow.findUnique({
    where: { id: workflowId }
  });
  
  if (!workflow) {
    throw new Error('Workflow not found');
  }
  
  // Find current step
  const step = workflow.steps.find(s => s.department === department && s.status === 'pending');
  
  if (!step) {
    throw new Error('Invalid step or already approved');
  }
  
  // Update step
  step.approver = approverId;
  step.status = 'approved';
  step.comments = comments || null;
  step.approvedAt = new Date();
  
  // Move to next step
  workflow.currentStep++;
  workflow.updatedAt = new Date();
  
  // Check if all steps approved
  if (workflow.steps.every(s => s.status === 'approved')) {
    workflow.status = ApprovalStatus.FINAL_APPROVED;
    
    // Send to Elasticsearch
    await sendToElasticsearch(workflow.uploadId);
    
    // Update Power BI
    await updatePowerBI(workflow.uploadId);
    
    // Notify couriers
    await notifyCouriers(workflow.uploadId);
  } else {
    // Notify next approver
    const nextStep = workflow.steps.find(s => s.status === 'pending');
    if (nextStep) {
      await notifyApprover(nextStep.department, workflowId);
    }
  }
  
  // Save workflow
  await db.approvalWorkflow.update({
    where: { id: workflowId },
    data: workflow
  });
  
  return workflow;
};
```

---

## ğŸ¨ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (UI Components)

### 1. Excel Upload Page

```tsx
// src/pages/ExcelUpload.tsx
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Card } from '@/components/ui/card';
import { Progress } from '@/components/ui/progress';

export default function ExcelUploadPage() {
  const [file, setFile] = useState<File | null>(null);
  const [uploading, setUploading] = useState(false);
  const [progress, setProgress] = useState(0);

  const handleUpload = async () => {
    if (!file) return;
    
    setUploading(true);
    // Upload logic here
    setUploading(false);
  };

  return (
    <div className="container mx-auto p-6" dir="rtl">
      <h1 className="text-3xl font-bold mb-6">Ø±ÙØ¹ Ù…Ù„Ù Excel Ø§Ù„ÙŠÙˆÙ…ÙŠ</h1>
      
      <Card className="p-6">
        <div className="space-y-4">
          <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
            <input
              type="file"
              accept=".xlsx,.xls"
              onChange={(e) => setFile(e.target.files?.[0] || null)}
              className="hidden"
              id="file-upload"
            />
            <label htmlFor="file-upload" className="cursor-pointer">
              <div className="text-gray-500">
                <p className="text-lg">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ù„ØªØ­Ù…ÙŠÙ„</p>
                <p className="text-sm mt-2">Ù…Ù„ÙØ§Øª Excel (.xlsx, .xls) Ø­ØªÙ‰ 10 Ù…ÙŠØ¬Ø§</p>
              </div>
            </label>
            
            {file && (
              <div className="mt-4">
                <p className="font-medium">{file.name}</p>
                <p className="text-sm text-gray-500">
                  {(file.size / 1024 / 1024).toFixed(2)} Ù…ÙŠØ¬Ø§
                </p>
              </div>
            )}
          </div>
          
          {uploading && (
            <Progress value={progress} className="w-full" />
          )}
          
          <Button
            onClick={handleUpload}
            disabled={!file || uploading}
            className="w-full"
          >
            {uploading ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...' : 'Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù'}
          </Button>
        </div>
      </Card>
    </div>
  );
}
```

### 2. Approval Dashboard

```tsx
// src/pages/ApprovalDashboard.tsx
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';

export default function ApprovalDashboard() {
  return (
    <div className="container mx-auto p-6" dir="rtl">
      <h1 className="text-3xl font-bold mb-6">Ù„ÙˆØ­Ø© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</h1>
      
      <div className="grid gap-4">
        {/* Approval card */}
        <Card className="p-6">
          <div className="flex justify-between items-start">
            <div>
              <h3 className="text-lg font-medium">Ù…Ù„Ù Excel - 2026-02-18</h3>
              <p className="text-sm text-gray-500 mt-1">
                150 Ù…Ù†Ø¯ÙˆØ¨ | 22,500 Ø·Ù„Ø¨ | 675,000 Ø±ÙŠØ§Ù„
              </p>
            </div>
            
            <Badge>Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</Badge>
          </div>
          
          <div className="mt-4 space-y-2">
            <ApprovalStep 
              step="Ù‚Ø³Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©" 
              status="approved" 
              approver="Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯"
            />
            <ApprovalStep 
              step="Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©" 
              status="pending" 
            />
            <ApprovalStep 
              step="Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©" 
              status="pending" 
            />
            <ApprovalStep 
              step="Ù‚Ø³Ù… Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª" 
              status="pending" 
            />
          </div>
          
          <div className="mt-4 flex gap-2">
            <Button>Ø§Ø¹ØªÙ…Ø§Ø¯</Button>
            <Button variant="outline">Ø±ÙØ¶</Button>
          </div>
        </Card>
      </div>
    </div>
  );
}
```

---

## ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù† (Security)

1. **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª:**
   - ÙØ­Øµ Ø§Ù…ØªØ¯Ø§Ø¯ Ø§Ù„Ù…Ù„Ù
   - ÙØ­Øµ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù
   - ÙØ­Øµ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù (malware scan)

2. **ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„:**
   - ÙÙ‚Ø· Ù…ÙˆØ¸ÙÙˆ Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙŠÙ…ÙƒÙ†Ù‡Ù… Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
   - ÙƒÙ„ Ù‚Ø³Ù… ÙŠØ±Ù‰ ÙÙ‚Ø· Ù…Ø§ ÙŠØ®ØµÙ‡
   - ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ© (audit log)

3. **ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:**
   - ØªØ´ÙÙŠØ± Ø§Ù„Ù…Ù„ÙØ§Øª ÙÙŠ S3
   - ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
   - HTTPS ÙÙ‚Ø· Ù„Ù„Ø§ØªØµØ§Ù„Ø§Øª

---

## ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± (Reports)

Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØŒ ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡:

1. **ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„:**
   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª
   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª

2. **ØªÙ‚Ø±ÙŠØ± Ù„ÙƒÙ„ Ù…Ù†Ø¯ÙˆØ¨:**
   - Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª
   - Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
   - Ø§Ù„Ù…Ø³ØªØ­Ù‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ

3. **ØªÙ‚Ø±ÙŠØ± Ù„ÙƒÙ„ Ù…Ù†ØµØ©:**
   - Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
   - Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù…

---

**ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«:** ÙØ¨Ø±Ø§ÙŠØ± 2026  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 1.0  
**Ø§Ù„Ø­Ø§Ù„Ø©:** Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ âœ…
